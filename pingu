#!/bin/sh

trap : INT TERM QUIT

source ~/.pingurc

command=$*
"$@"
if [ $? -eq 0 ]; then
    color="good"
    text=":white_check_mark:"
else
    color="danger"
    text=":x:"
fi

echo " 
{
    \"username\": \"pingu\",
    \"icon_emoji\": \":penguin:\",
    \"attachments\": [
        {
            \"fallback\": \"${text} ${command}\",
            \"text\": \"${text} \`${command}\`\",
            \"color\": \"${color}\",
            \"footer\": \"$(hostname)\"
        }
    ]
}
" | curl -sSLd @- "${webhook}" > /dev/null

exit ${status}
